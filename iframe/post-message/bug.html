<!DOCTYPE html>
<html lang="zh-Hans">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="author" content="xgqfrms">
    <meta name="generator" content="VS code">
    <title>iframe parent.PostMessage bug</title>
    <style>
      section {
        width: 100vw;
        height: 100%;
        max-height: 200px;
        overflow-y: auto;
        background: #ccc;
        color: #fff;
      }
    </style>
</head>
<body>
    <header>
        <h1>iframe parent.PostMessage bug</h1>
    </header>
    <main>
        <section id="app">
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
            <p class="">❌iframe parent.PostMessage bug❌</p>
        </section>
        <article></article>
    <main>
    <footer>
        <p>copyriht&copy; xgqfrms 2021</p>
    </footer>
<script>

const sendScrollMessage = () => {
  // const app = document.querySelector('#app-content');
  // const clientHeight = app.clientHeight;
  console.log('\nwindow =', window);
  console.log('window.parent =', window.parent);
  console.log('window.top =', window.top);
  console.log('window.opener =', window.opener);
  window.top.postMessage({
      type: 'iframeHeight',
      // height: clientHeight,
      height: 2000,
      window: 'window.top',
  }, 'https://iframe.xgqfrms.xyz/post-message/bug.html');
  window.parent.postMessage({
      type: 'iframeHeight',
      // height: clientHeight,
      height: 2000,
      window: 'window.parent',
  }, 'https://iframe.xgqfrms.xyz/post-message/bug.html');
  window.postMessage({
      type: 'iframeHeight',
      // height: clientHeight,
      height: 2000,
      window: 'window',
  }, 'https://iframe.xgqfrms.xyz/post-message/bug.html');
  parent.postMessage({
      type: 'iframeHeight',
      // height: clientHeight,
      height: 2000,
      window: 'parent',
  }, 'https://iframe.xgqfrms.xyz/post-message/bug.html');
};

const startTime = new Date().getTime();

window.onload = function () {
  const endTime = new Date().getTime();
  console.log('页面加载完成');
  console.log('页面加载时间', endTime - startTime);
  sendScrollMessage();
}
</script>
</body>
</html>
